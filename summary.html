<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resumen</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <header>
        <h1>Resumen</h1>
    </header>
    <main>
        <div class="summary-container">
            <h2>Tus Componentes Seleccionados</h2>
            <ul class="summary-list">
                <li data-component="cpu">
                    <strong>CPU:</strong> <span class="component-value"></span> - <span class="component-price"></span>
                </li>
                <li data-component="gpu">
                    <strong>GPU:</strong> <span class="component-value"></span> - <span class="component-price"></span>
                </li>
                <li data-component="ram">
                    <strong>RAM:</strong> <span class="component-value"></span> - <span class="component-price"></span>
                </li>
                <li data-component="storage">
                    <strong>Almacenamiento:</strong> <span class="component-value"></span> - <span class="component-price"></span>
                </li>
                <li data-component="case">
                    <strong>Caja:</strong> <span class="component-value"></span> - <span class="component-price"></span>
                </li>
            </ul>
            <p class="total-price"><strong>Precio Total:</strong> €<span id="totalPrice"></span></p>
            <button class="buy-button">Comprar Ahora</button>
        </div>
    </main>
    <div class="optional-components">
        <h3>Componentes Opcionales</h3>
        <form id="optionalForm">
            <label>
                <input type="checkbox" name="optional" value="keyboard" data-price="30">
                Teclado (€30)
            </label><br>
            <label>
                <input type="checkbox" name="optional" value="mouse" data-price="20">
                Ratón (€20)
            </label><br>
            <label>
                <input type="checkbox" name="optional" value="monitor" data-price="150">
                Pantalla (€150)
            </label>
        </form>
    </div>
    <script type="module">
        import { prices } from './js/prices.js';

        const params = new URLSearchParams(window.location.search);
        const totalPriceElement = document.getElementById('totalPrice');

        // Pre-fill required components in the summary
        document.querySelectorAll('[data-component]').forEach(item => {
            const componentId = item.dataset.component;
            const value = params.get(componentId);
            const price = prices[value] || 0;

            item.querySelector('.component-value').textContent = value;
            item.querySelector('.component-price').textContent = `€${price}`;
        });

        // Calculate base price for required components
        let totalPrice = Array.from(document.querySelectorAll('[data-component]'))
            .map(item => prices[params.get(item.dataset.component)] || 0)
            .reduce((sum, price) => sum + price, 0);

        totalPriceElement.textContent = totalPrice;

        // Update price when optional components are selected
        document.getElementById('optionalForm').addEventListener('change', () => {
            const optionalPrice = Array.from(document.querySelectorAll('input[name="optional"]:checked'))
                .map(input => parseFloat(input.dataset.price))
                .reduce((sum, price) => sum + price, 0);

            totalPriceElement.textContent = totalPrice + optionalPrice;
        });
    </script>
</body>
</html>